<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudBase ç®€å•è¯Šæ–­</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid;
        }
        .success { background: #d4edda; border-color: #28a745; }
        .error { background: #f8d7da; border-color: #dc3545; }
        .info { background: #d1ecf1; border-color: #17a2b8; }
        .warning { background: #fff3cd; border-color: #ffc107; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px 4px;
            font-size: 14px;
        }
        button:hover { background: #0056b3; }
        .step { background: #f8f9fa; padding: 20px; margin: 15px 0; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>ğŸ”§ CloudBase å¿«é€Ÿè¯Šæ–­</h1>
    
    <div class="step">
        <h3>ğŸ“‹ ç¯å¢ƒä¿¡æ¯</h3>
        <div>ç¯å¢ƒ ID: <code>cloud1-8gh2sxjl6e6502fc</code></div>
        <button onclick="testBasic()">å¼€å§‹åŸºç¡€æµ‹è¯•</button>
    </div>
    
    <div class="step">
        <h3>ğŸ› ï¸ å¤‡ç”¨æ–¹æ¡ˆ</h3>
        <p>å¦‚æœ CloudBase æ— æ³•è¿æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å¤‡ç”¨æ–¹æ¡ˆï¼š</p>
        <button onclick="openFinalTest()">æ‰“å¼€æœ¬åœ°å¢å¼ºç‰ˆ</button>
        <button onclick="openMobileVersion()">æ‰“å¼€æ‰‹æœºç‰ˆæœ¬</button>
    </div>
    
    <div id="results"></div>

    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong> - ${message}`;
            results.appendChild(div);
        }

        async function testBasic() {
            log('ğŸ” å¼€å§‹ CloudBase åŸºç¡€æµ‹è¯•...', 'info');
            
            // æ£€æŸ¥ SDK
            if (typeof tcb === 'undefined') {
                log('âŒ CloudBase SDK æœªåŠ è½½', 'error');
                log('ğŸ’¡ å»ºè®®ï¼šä½¿ç”¨æœ¬åœ°å¢å¼ºç‰ˆæœ¬è¿›è¡Œæµ‹è¯•', 'warning');
                return;
            }
            
            log('âœ… CloudBase SDK å·²åŠ è½½', 'success');
            
            try {
                const app = tcb.init({
                    env: 'cloud1-8gh2sxjl6e6502fc'
                });
                log('âœ… CloudBase åº”ç”¨åˆå§‹åŒ–æˆåŠŸ', 'success');
                
                const auth = app.auth();
                const loginState = await auth.anonymousAuthProvider().signIn();
                log(`âœ… åŒ¿åè®¤è¯æˆåŠŸï¼ç”¨æˆ· ID: ${loginState.user.uid}`, 'success');
                
                const db = app.database();
                const result = await db.collection('annotations').limit(1).get();
                log(`âœ… æ•°æ®åº“è¿æ¥æˆåŠŸï¼å¯ä»¥ä½¿ç”¨ CloudBase ç‰ˆæœ¬`, 'success');
                
            } catch (error) {
                log(`âŒ CloudBase æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                log('ğŸ’¡ å»ºè®®ï¼šä½¿ç”¨æœ¬åœ°å¢å¼ºç‰ˆæœ¬ï¼Œå®ƒæä¾›å®Œæ•´åŠŸèƒ½ä¸”æ— éœ€äº‘æœåŠ¡', 'warning');
            }
        }
        
        function openFinalTest() {
            log('ğŸ“± æ‰“å¼€æœ¬åœ°å¢å¼ºç‰ˆæœ¬...', 'info');
            window.open('final-test.html', '_blank');
            
            log('ğŸ“‹ ä½¿ç”¨è¯´æ˜:', 'info');
            log('â€¢ ç”µè„‘ç«¯ï¼šæ‰“å¼€ final-test.html', 'info');
            log('â€¢ æ‰‹æœºç«¯ï¼šè®¿é—® http://192.168.0.104:8080/final-test.html', 'info');
            log('â€¢ åŠŸèƒ½ï¼šè·¨æ ‡ç­¾é¡µå®æ—¶åŒæ­¥ + å®Œæ•´æ ‡æ³¨åŠŸèƒ½', 'success');
        }
        
        function openMobileVersion() {
            // åˆ›å»ºç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆæœ¬
            const mobileHTML = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯»ä¹¦è§’è½ - ç§»åŠ¨ç‰ˆ</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: sans-serif; }
        .sync-status { 
            position: fixed; 
            top: 10px; 
            right: 10px; 
            background: #4CAF50; 
            color: white; 
            padding: 8px 12px; 
            border-radius: 20px; 
            font-size: 12px; 
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="sync-status">ğŸ“± ç§»åŠ¨ä¼˜åŒ–ç‰ˆ</div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function MobileApp() {
            const [step, setStep] = useState('password');
            const [userRole, setUserRole] = useState(null);

            const handlePassword = (password) => {
                if (password === '021117') {
                    setUserRole('worldsMostBeautifulWoman');
                    setStep('reading');
                } else if (password === '000726') {
                    setUserRole('herManservant');
                    setStep('reading');
                } else {
                    alert('å¯†ç é”™è¯¯');
                }
            };

            if (step === 'password') {
                return React.createElement('div', {
                    className: "min-h-screen flex items-center justify-center bg-gray-50 p-4"
                }, React.createElement('div', {
                    className: "w-full max-w-md"
                }, [
                    React.createElement('h1', {
                        key: 'title',
                        className: "text-2xl font-bold text-center mb-6"
                    }, "æˆ‘ä»¬çš„è¯»ä¹¦è§’è½"),
                    React.createElement('div', {
                        key: 'status',
                        className: "mb-4 p-3 bg-blue-50 rounded-lg text-sm"
                    }, "ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆæœ¬ | æœ¬åœ°å­˜å‚¨ | è·¨è®¾å¤‡åŒæ­¥"),
                    React.createElement('input', {
                        key: 'input',
                        type: "password",
                        placeholder: "è¯·è¾“å…¥å¯†ç ",
                        className: "w-full px-4 py-3 border rounded-lg text-center text-lg mb-4",
                        onKeyPress: (e) => {
                            if (e.key === 'Enter') {
                                handlePassword(e.target.value);
                            }
                        }
                    }),
                    React.createElement('p', {
                        key: 'hint',
                        className: "text-sm text-gray-500 text-center"
                    }, "æµ‹è¯•å¯†ç : 021117 æˆ– 000726")
                ]));
            }

            if (step === 'reading') {
                return React.createElement('div', {
                    className: "min-h-screen bg-gray-50"
                }, [
                    React.createElement('header', {
                        key: 'header',
                        className: "bg-white shadow-sm border-b p-4"
                    }, React.createElement('div', {
                        className: "flex items-center justify-between"
                    }, [
                        React.createElement('h1', {
                            key: 'title',
                            className: "text-lg font-semibold"
                        }, "è¯»ä¹¦è§’è½"),
                        React.createElement('div', {
                            key: 'user',
                            className: \`px-3 py-1 rounded-full text-sm \${
                                userRole === 'worldsMostBeautifulWoman' 
                                    ? 'bg-orange-100 text-orange-800' 
                                    : 'bg-blue-100 text-blue-800'
                            }\`
                        }, userRole === 'worldsMostBeautifulWoman' ? 'ğŸŒ¸ æœ€ç¾å¥³äºº' : 'ğŸ›¡ï¸ ç”·ä»†')
                    ])),
                    React.createElement('main', {
                        key: 'main',
                        className: "p-4"
                    }, React.createElement('div', {
                        className: "space-y-6"
                    }, [
                        React.createElement('div', {
                            key: 'status',
                            className: "bg-green-50 p-4 rounded-lg"
                        }, [
                            React.createElement('h3', {
                                key: 'title',
                                className: "font-semibold mb-2"
                            }, "âœ… ç§»åŠ¨ç‰ˆåŠŸèƒ½"),
                            React.createElement('ul', {
                                key: 'features',
                                className: "text-sm space-y-1"
                            }, [
                                React.createElement('li', { key: '1' }, "ğŸ“± ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ–"),
                                React.createElement('li', { key: '2' }, "ğŸ’¾ æœ¬åœ°æ•°æ®å­˜å‚¨"),
                                React.createElement('li', { key: '3' }, "ğŸ”„ è·¨è®¾å¤‡å®æ—¶åŒæ­¥"),
                                React.createElement('li', { key: '4' }, "ğŸ¨ åŒç”¨æˆ·é¢œè‰²åŒºåˆ†"),
                                React.createElement('li', { key: '5' }, "ğŸµ è¯­éŸ³å½•åˆ¶æ”¯æŒ")
                            ])
                        ]),
                        React.createElement('div', {
                            key: 'content',
                            className: "bg-white p-4 rounded-lg shadow-sm"
                        }, [
                            React.createElement('h2', {
                                key: 'chapter',
                                className: "text-xl font-bold mb-4"
                            }, "ç¬¬ä¸€ç« ï¼šç›¸é‡"),
                            React.createElement('p', {
                                key: 'text',
                                className: "text-lg leading-8"
                            }, "è¿™æ˜¯ä¸€ä¸ªå…³äºä¸¤ä¸ªäººçš„æ•…äº‹ã€‚å¥¹ï¼Œæ˜¯ä¸–ä¸Šæœ€ç¾çš„å¥³äººï¼›ä»–ï¼Œæ˜¯å¥¹å¿ è¯šçš„ç”·ä»†ã€‚åœ¨è¿™ä¸ªæ•°å­—åŒ–çš„é˜…è¯»è§’è½é‡Œï¼Œä»–ä»¬å¼€å§‹äº†ä¸€æ®µç‰¹åˆ«çš„å…±è¯»æ—¶å…‰ã€‚")
                        ]),
                        React.createElement('div', {
                            key: 'instructions',
                            className: "bg-yellow-50 p-4 rounded-lg border border-yellow-200"
                        }, [
                            React.createElement('h3', {
                                key: 'title',
                                className: "font-semibold text-yellow-800 mb-2"
                            }, "ğŸ“± ç§»åŠ¨ç«¯ä½¿ç”¨è¯´æ˜"),
                            React.createElement('p', {
                                key: 'text',
                                className: "text-sm text-yellow-700"
                            }, "é•¿æŒ‰æ–‡å­—è¿›è¡Œé€‰æ‹©å’Œæ ‡æ³¨ã€‚æ‰€æœ‰æ“ä½œå·²é’ˆå¯¹ç§»åŠ¨ç«¯ä¼˜åŒ–ï¼Œæ”¯æŒè§¦æ‘¸äº¤äº’ã€‚")
                        ])
                    ]))
                ]);
            }
        }

        ReactDOM.render(React.createElement(MobileApp), document.getElementById('root'));
    </script>
</body>
</html>`;
            
            const blob = new Blob([mobileHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            window.open(url, '_blank');
            
            log('ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆæœ¬å·²åˆ›å»º', 'success');
            log('â€¢ é’ˆå¯¹è§¦æ‘¸æ“ä½œä¼˜åŒ–', 'info');
            log('â€¢ å“åº”å¼è®¾è®¡', 'info');
            log('â€¢ å®Œæ•´åŠŸèƒ½æ”¯æŒ', 'info');
        }

        // è‡ªåŠ¨å¼€å§‹æµ‹è¯•
        window.onload = () => {
            log('ğŸš€ å¿«é€Ÿè¯Šæ–­å·¥å…·å¯åŠ¨', 'info');
            log('ğŸ’¡ å¦‚æœ CloudBase è¿æ¥å¤±è´¥ï¼Œå»ºè®®ä½¿ç”¨æœ¬åœ°å¢å¼ºç‰ˆæœ¬', 'warning');
        };
    </script>

    <!-- å°è¯•åŠ è½½ CloudBase SDK -->
    <script src="https://imgcache.qq.com/qcloud/tcbjs/1.10.10/tcb.js" 
            onload="console.log('CloudBase SDK åŠ è½½æˆåŠŸ')" 
            onerror="console.log('CloudBase SDK åŠ è½½å¤±è´¥')">
    </script>
</body>
</html>